<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="next" title="Pyramidalization" href="pyramidalization.html" /><link rel="prev" title="Dispersion descriptor" href="dispersion.html" />

    <!-- Generated with Sphinx 7.4.7 and Furo 2024.08.06 -->
        <title>Local force constants - ᴍᴏʀғᴇᴜs</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=a746c00c" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/tabs.css?v=4c969af8" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=302659d7" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">ᴍᴏʀғᴇᴜs</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="_static/logo-light.svg" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="_static/logo-dark.svg" alt="Dark Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="notes.html">Notes on usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command line interface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Methods</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="bite_angle.html">Bite angle</a></li>
<li class="toctree-l1"><a class="reference internal" href="buried_volume.html">Buried volume</a></li>
<li class="toctree-l1"><a class="reference internal" href="cone_angle.html">Cone angle</a></li>
<li class="toctree-l1"><a class="reference internal" href="conformer.html">Conformer tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="dispersion.html">Dispersion descriptor</a></li>
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">Local force constants</a></li>
<li class="toctree-l1"><a class="reference internal" href="pyramidalization.html">Pyramidalization</a></li>
<li class="toctree-l1"><a class="reference internal" href="sasa.html">Solvent accessible surface area</a></li>
<li class="toctree-l1"><a class="reference internal" href="solid_angle.html">Solid angle</a></li>
<li class="toctree-l1"><a class="reference internal" href="sterimol.html">Sterimol</a></li>
<li class="toctree-l1"><a class="reference internal" href="xtb.html">XTB</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="api/morfeus.html">morfeus package</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of morfeus package</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.bite_angle.html">morfeus.bite_angle module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.buried_volume.html">morfeus.buried_volume module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.calculators.html">morfeus.calculators module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.cone_angle.html">morfeus.cone_angle module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.conformer.html">morfeus.conformer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.d3_data.html">morfeus.d3_data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.data.html">morfeus.data module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.dispersion.html">morfeus.dispersion module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.geometry.html">morfeus.geometry module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.io.html">morfeus.io module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.local_force.html">morfeus.local_force module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.plotting.html">morfeus.plotting module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.pyramidalization.html">morfeus.pyramidalization module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.qc.html">morfeus.qc module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.sasa.html">morfeus.sasa module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.solid_angle.html">morfeus.solid_angle module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.sterimol.html">morfeus.sterimol module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.typing.html">morfeus.typing module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.utils.html">morfeus.utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.visible_volume.html">morfeus.visible_volume module</a></li>
<li class="toctree-l2"><a class="reference internal" href="api/morfeus.xtb.html">morfeus.xtb module</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Source</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/digital-chemistry-laboratory/morfeus">GitHub</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/local_force.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="local-force-constants">
<h1>Local force constants<a class="headerlink" href="#local-force-constants" title="Link to this heading">¶</a></h1>
<p>Local force constants can be calculated with the local modes method
<a class="footnote-reference brackets" href="#footcite-konkoli-new-1998" id="id1" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> or the compliance matrix method
<a class="footnote-reference brackets" href="#footcite-brandhorst-how-2008" id="id2" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>. ᴍᴏʀғᴇᴜs can use the output of the <a class="reference external" href="https://gaussian.com/">Gaussian</a>,
<a class="reference external" href="https://xtb-docs.readthedocs.io/en/latest/contents.html">xtb</a>, or <a class="reference external" href="https://github.com/zorkzou/UniMoVib">UniMoVib</a> programs.</p>
<section id="preparing-input">
<h2>Preparing input<a class="headerlink" href="#preparing-input" title="Link to this heading">¶</a></h2>
<p>The LocalForce class needs input from quantum-chemical frequency calculations.
Therefore, the instructions are a bit more involved. This input can be read
using the <code class="docutils literal notranslate"><span class="pre">load_file</span></code> method, and ᴍᴏʀғᴇᴜs can also calculate some quantities
using its built-in normal mode analysis and internal coordinate codes.</p>
<section id="local-modes">
<h3>Local modes<a class="headerlink" href="#local-modes" title="Link to this heading">¶</a></h3>
<p>The local modes approach needs the normal modes in internal coordinates, here
called <em>internal modes</em>, as well as the normal mode force constants. The
internal modes can either be read from file or calculated with ᴍᴏʀғᴇᴜs.
Specifically, the internal modes can be computed from the normal modes and the
Wilson B matrix. For local frequencies, additional input is needed.</p>
<figure class="align-default" id="id11">
<img alt="_images/local.svg" src="_images/local.svg" />
<figcaption>
<p><span class="caption-text">Input needed for the local modes approach.</span><a class="headerlink" href="#id11" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="compliance-matrix">
<h3>Compliance matrix<a class="headerlink" href="#compliance-matrix" title="Link to this heading">¶</a></h3>
<p>The compliance matrix method needs the Hessian matrix and the Wilson B matrix.
For local frequencies, the elements are also needed (for their atomic masses).</p>
<figure class="align-default" id="id12">
<img alt="_images/compliance.svg" src="_images/compliance.svg" />
<figcaption>
<p><span class="caption-text">Input needed for the compliance matrix method.</span><a class="headerlink" href="#id12" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="recommended-input">
<h3>Recommended input<a class="headerlink" href="#recommended-input" title="Link to this heading">¶</a></h3>
<p>The table below summarizes the recommended input to ᴍᴏʀғᴇᴜs from the
supported programs. More details are given below.</p>
<div class="table-wrapper colwidths-auto docutils container" id="id13">
<table class="docutils align-center" id="id13">
<caption><span class="caption-text">Recommended input.</span><a class="headerlink" href="#id13" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>Gaussian</p></th>
<th class="head"><p>UniMoVib</p></th>
<th class="head"><p>xtb</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Local modes</p></td>
<td><p>log</p></td>
<td><p>log</p></td>
<td><p>hessian</p></td>
</tr>
<tr class="row-odd"><td><p>Compliance</p></td>
<td><p>fchk</p></td>
<td><p>umv/local</p></td>
<td><p>hessian</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="gaussian">
<h3>Gaussian<a class="headerlink" href="#gaussian" title="Link to this heading">¶</a></h3>
<p>Gaussian can provide the complete input for both the local modes and the
compliance matrix methods. The <em>log</em> file is recommended as input for the the
local modes method, and the <em>fchk</em> file for the compliance matrix method.
The Gaussian input file should be prepared with the following keywords
included (appropriate method and basis set need to be added as well).</p>
<div class="table-wrapper docutils container">
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>log</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">freq=intmodes</span> <span class="pre">iop(7/75=-1)</span> <span class="pre">iop(1/33=3)</span></code></p></td>
</tr>
<tr class="row-even"><td><p>fchk</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">freq=intmodes</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<p><code class="docutils literal notranslate"><span class="pre">iop(7/75=1)</span></code> triggers printing of the internal modes with full accuracy,
while <code class="docutils literal notranslate"><span class="pre">iop(1/33=3)</span></code> triggers printing of the Wilson B matrix. The table below
lists all the quantities read by each approach. fchk files should be generated
with <code class="docutils literal notranslate"><span class="pre">formchk</span> <span class="pre">-3</span></code> to obtain maximum printout of internal coordinates.</p>
<div class="table-wrapper colwidths-auto docutils container" id="id14">
<table class="docutils align-center" id="id14">
<caption><span class="caption-text">Quantities from Gaussian files.</span><a class="headerlink" href="#id14" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Quantity</p></th>
<th class="head"><p>log</p></th>
<th class="head"><p>fck</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Elements</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>Coordinates</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>Internal modes</p></td>
<td><p>x</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Internal coordinates</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>B Matrix</p></td>
<td><p>x</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Normal modes</p></td>
<td></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>Hessian</p></td>
<td></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>Force constants</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
</tr>
</tbody>
</table>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Additional accuracy for local modes calculations can be achieved by loading
also the <em>fchk</em> file which contains the normal mode force constants to
higher accuracy.</p>
</div>
</section>
<section id="unimovib">
<h3>UniMoVib<a class="headerlink" href="#unimovib" title="Link to this heading">¶</a></h3>
<p>The UniMoVib program can do vibrational analysis for a range of different
quantum-chemical programs. The user needs to define internal coordinates in
addition to the information that can be read from the files. For the local
modes method, the <em>log</em> file is recommended. For the compliance matrix method,
either the <em>umv</em> or the <em>local</em> files are recommended.</p>
<div class="table-wrapper colwidths-auto docutils container" id="id15">
<table class="docutils align-center" id="id15">
<caption><span class="caption-text">Quantities from UniMoVib files.</span><a class="headerlink" href="#id15" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Quantity</p></th>
<th class="head"><p>local</p></th>
<th class="head"><p>log</p></th>
<th class="head"><p>umv</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Elements</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>Coordinates</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>Internal modes</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Internal coordinates</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>B Matrix</p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Normal modes</p></td>
<td><p>x</p></td>
<td><p>x</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Hessian</p></td>
<td><p>x</p></td>
<td></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>Force constants</p></td>
<td></td>
<td><p>x</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<p>The <em>log</em> file is the standard output of the program. The <em>umw</em> file and the
<em>local</em> file can be generated by specifying them in the input file:</p>
<div class="literal-block-wrapper docutils container" id="id16">
<div class="code-block-caption"><span class="caption-text">Example UniMoVib input file</span><a class="headerlink" href="#id16" title="Link to this code">¶</a></div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>a test job

$contrl
  qcprog=&quot;gaussian&quot;
<span class="hll">  iflocal=.t.
</span><span class="hll">  ifsave=.t.
</span>$end

$qcdata
  fchk=&quot;freq.fchk&quot;
$end
</pre></div>
</div>
</div>
</section>
<section id="xtb">
<h3>xtb<a class="headerlink" href="#xtb" title="Link to this heading">¶</a></h3>
<p>The xtb program can provide the Hessian. The file <em>hessian</em> is generated by the
xtb program as a result of a frequency calculation. It needs to be used
together with a normal mode analysis and separate internal coordinate input.</p>
<div class="table-wrapper colwidths-auto docutils container" id="id17">
<table class="docutils align-center" id="id17">
<caption><span class="caption-text">Quantities from xtb files.</span><a class="headerlink" href="#id17" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Quantity</p></th>
<th class="head"><p>hessian</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Elements</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Coordinates</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Internal modes</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Internal coordinates</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>B Matrix</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Normal modes</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Hessian</p></td>
<td><p>x</p></td>
</tr>
<tr class="row-odd"><td><p>Force constants</p></td>
<td></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="geometry-optimizations">
<h3>Geometry optimizations<a class="headerlink" href="#geometry-optimizations" title="Link to this heading">¶</a></h3>
<p>Local force constants and frequencies are based on the harmonic approximation
that is valid only at stationary points (minima and transition states) on the
potential energy surface. Therefore, the geometry optimizations need to be of
good quality. For difficult examples on flat surfaces, this can mean
increasing the convergence criteria of the quantum-chemical program.
Vibrations with small imaginary frequencies should be eliminated as much as
possible. The local modes method with standards settings is somewhat robust to
the presence of these vibrations , while they can result in artifacts with the
compliance matrix method. Therefore, the local modes method is recommended in
these cases.</p>
<p>For transition states, the imaginary mode corresponding to the reaction is
projected out with the local modes approach. This also means that local force
constant involving the atoms corresponding to this imaginary mode are
meaningless and should not be used. Only the local modes method can be used
for transition states.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Transition states can only be treated with the local modes method. Force
constants and frequencies of the atoms corresponding to the imaginary mode
should not be used.</p>
</div>
</section>
</section>
<section id="module">
<h2>Module<a class="headerlink" href="#module" title="Link to this heading">¶</a></h2>
<p>The LocalForce class is provided to calculate and store the local force
constants and frequencies.</p>
<div class="literal-block-wrapper docutils container" id="id18">
<div class="code-block-caption"><span class="caption-text">Example with Gaussian and local modes method.</span><a class="headerlink" href="#id18" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">morfeus</span> <span class="kn">import</span> <span class="n">LocalForce</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span> <span class="o">=</span> <span class="n">LocalForce</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;freq-lm.log&quot;</span><span class="p">,</span> <span class="s2">&quot;gaussian&quot;</span><span class="p">,</span> <span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">compute_local</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">compute_frequencies</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fc</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">get_local_force_constant</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span>
<span class="go">5.364289643211871</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">get_local_frequency</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
<span class="go">3129.3126301763527</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id19">
<div class="code-block-caption"><span class="caption-text">Example with Gaussian and compliance matrix method.</span><a class="headerlink" href="#id19" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">morfeus</span> <span class="kn">import</span> <span class="n">LocalForce</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span> <span class="o">=</span> <span class="n">LocalForce</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;freq.fchk&quot;</span><span class="p">,</span> <span class="s2">&quot;gaussian&quot;</span><span class="p">,</span> <span class="s2">&quot;fchk&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">compute_compliance</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">compute_frequencies</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fc</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">get_local_force_constant</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span>
<span class="go">5.364398642985929</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">get_local_frequency</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
<span class="go">3129.352986019491</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id20">
<div class="code-block-caption"><span class="caption-text">Example with xtb and local modes method.</span><a class="headerlink" href="#id20" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">morfeus</span> <span class="kn">import</span> <span class="n">LocalForce</span><span class="p">,</span> <span class="n">read_xyz</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">elements</span><span class="p">,</span> <span class="n">coordinates</span> <span class="o">=</span> <span class="n">read_xyz</span><span class="p">(</span><span class="s2">&quot;xtbopt.xyz&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span> <span class="o">=</span> <span class="n">LocalForce</span><span class="p">(</span><span class="n">elements</span><span class="p">,</span> <span class="n">coordinates</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;hessian&quot;</span><span class="p">,</span> <span class="s2">&quot;xtb&quot;</span><span class="p">,</span> <span class="s2">&quot;hessian&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">normal_mode_analysis</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">detect_bonds</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lf</span><span class="o">.</span><span class="n">internal_coordinates</span><span class="p">)</span>
<span class="go">[Bond(1, 4), Bond(1, 3), Bond(1, 2), Bond(1, 5)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">compute_local</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">compute_frequencies</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fc</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">get_local_force_constant</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span>
<span class="go">5.190222259808879</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">get_local_frequency</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
<span class="go">3078.130379468432</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id21">
<div class="code-block-caption"><span class="caption-text">Example with UniMoVib and the local modes method.</span><a class="headerlink" href="#id21" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">morfeus</span> <span class="kn">import</span> <span class="n">LocalForce</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span> <span class="o">=</span> <span class="n">LocalForce</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;job.out&quot;</span><span class="p">,</span> <span class="s2">&quot;unimovib&quot;</span><span class="p">,</span> <span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">detect_bonds</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">compute_local</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">compute_frequencies</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fc</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">get_local_force_constant</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span>
<span class="go">5.364347084281302</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">get_local_frequency</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
<span class="go">3129.337947449028</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id22">
<div class="code-block-caption"><span class="caption-text">Example with adding internal coordinates manually</span><a class="headerlink" href="#id22" title="Link to this code">¶</a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">morfeus</span> <span class="kn">import</span> <span class="n">LocalForce</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span> <span class="o">=</span> <span class="n">LocalForce</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">load_file</span><span class="p">(</span><span class="s2">&quot;job.out&quot;</span><span class="p">,</span> <span class="s2">&quot;unimovib&quot;</span><span class="p">,</span> <span class="s2">&quot;log&quot;</span><span class="p">)</span>
<span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">add_internal_coordinate</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
</span><span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">add_internal_coordinate</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
</span><span class="hll"><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lf</span><span class="o">.</span><span class="n">internal_coordinates</span><span class="p">)</span>
</span><span class="hll"><span class="go">[Bond(1, 2), Angle(1, 2, 3)]</span>
</span><span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">compute_local</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">compute_frequencies</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fc</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">get_local_force_constant</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">fc</span><span class="p">)</span>
<span class="go">5.364347084281298</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">freq</span> <span class="o">=</span> <span class="n">lf</span><span class="o">.</span><span class="n">get_local_frequency</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
<span class="go">3129.337947449028</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lf</span><span class="o">.</span><span class="n">print_report</span><span class="p">(</span><span class="n">angles</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">angle_units</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">Coordinate                            Force constant (mDyne/Å, mDyne Å rad^(-2))             Frequency (cm^-1)</span>
<span class="go">Bond(1, 2)                                                                 5.364                          3129</span>
<span class="go">Angle(1, 2, 3)                                                             2.416                          1687</span>
</pre></div>
</div>
</div>
<p>For the local modes method, projection of imaginary frequencies can be
controlled with the <code class="docutils literal notranslate"><span class="pre">project_imag=&lt;bool&gt;</span></code> keyword to the <code class="docutils literal notranslate"><span class="pre">compute_local</span></code>
method. The cutoff for low-frequency modes can be controlled with
<code class="docutils literal notranslate"><span class="pre">cutoff=&lt;float&gt;</span></code>. Internal coordinates can be added with the
<code class="docutils literal notranslate"><span class="pre">add_internal_coordinate</span></code> method.</p>
<p>For more detailed information, use <code class="docutils literal notranslate"><span class="pre">help(LocalForce)</span></code> or see the API
documentation: <a class="reference internal" href="api/morfeus.local_force.html#morfeus.local_force.LocalForce" title="morfeus.local_force.LocalForce"><code class="xref py py-class docutils literal notranslate"><span class="pre">LocalForce</span></code></a>.</p>
</section>
<section id="command-line-script">
<h2>Command line script<a class="headerlink" href="#command-line-script" title="Link to this heading">¶</a></h2>
<p>The command line script provides access to the basic functionality through
the terminal.</p>
<div class="literal-block-wrapper docutils container" id="id23">
<div class="code-block-caption"><span class="caption-text">Example with Gaussian log file.</span><a class="headerlink" href="#id23" title="Link to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>morfeus<span class="w"> </span>local_force<span class="w"> </span>-<span class="w"> </span>-<span class="w"> </span>load_file<span class="w"> </span>freq-lm.log<span class="w"> </span>gaussian<span class="w"> </span>log<span class="w"> </span>-<span class="w"> </span>compute_local<span class="w"> </span>-<span class="w"> </span>compute_frequencies<span class="w"> </span>-<span class="w"> </span>print_report
Coordinate<span class="w">                                              </span>Force<span class="w"> </span>constant<span class="w"> </span><span class="o">(</span>mDyne/Å<span class="o">)</span><span class="w">              </span>Frequency<span class="w"> </span><span class="o">(</span>cm⁻¹<span class="o">)</span>
Bond<span class="o">(</span><span class="m">1</span>,<span class="w"> </span><span class="m">2</span><span class="o">)</span><span class="w">                                                                 </span><span class="m">5</span>.364<span class="w">                          </span><span class="m">3129</span>
Bond<span class="o">(</span><span class="m">1</span>,<span class="w"> </span><span class="m">3</span><span class="o">)</span><span class="w">                                                                 </span><span class="m">5</span>.364<span class="w">                          </span><span class="m">3129</span>
Bond<span class="o">(</span><span class="m">1</span>,<span class="w"> </span><span class="m">4</span><span class="o">)</span><span class="w">                                                                 </span><span class="m">5</span>.365<span class="w">                          </span><span class="m">3129</span>
Bond<span class="o">(</span><span class="m">1</span>,<span class="w"> </span><span class="m">5</span><span class="o">)</span><span class="w">                                                                 </span><span class="m">5</span>.364<span class="w">                          </span><span class="m">3129</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Breaking up the command:</p>
<dl class="simple">
<dt>morfeus local_force - -</dt><dd><p>Call LocalForce without any geometry file and without arguments. Return
object.</p>
</dd>
<dt>load_file freq_lm.log gaussian log -</dt><dd><p>Call LocalForce.load_file with three arguments. Return object for chaining.</p>
</dd>
<dt>compute_local -</dt><dd><p>Call LocalForce.compute_local. Return object for chaining.</p>
</dd>
<dt>compute_frequencies -</dt><dd><p>Call LocalForce.compute_frequencies. Return object for chaining.</p>
</dd>
<dt>print_report</dt><dd><p>Call LocalFroce.print_report. Return result</p>
</dd>
</dl>
</div>
<p>Another example using xtb where a geometry file is loaded:</p>
<div class="literal-block-wrapper docutils container" id="id24">
<div class="code-block-caption"><span class="caption-text">Example with xtb and hessian file.</span><a class="headerlink" href="#id24" title="Link to this code">¶</a></div>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span>$<span class="w"> </span>morfeus<span class="w"> </span>local_force<span class="w"> </span>xtb.xyz<span class="w"> </span>-<span class="w"> </span>-<span class="w"> </span>load_file<span class="w"> </span>hessian<span class="w"> </span>xtb<span class="w"> </span>hessian<span class="w"> </span>-<span class="w"> </span>normal_mode_analysis<span class="w"> </span>-<span class="w">  </span>detect_bonds<span class="w"> </span>-<span class="w"> </span>compute_local<span class="w"> </span>-<span class="w"> </span>compute_frequencies<span class="w"> </span>-<span class="w"> </span>print_report
Coordinate<span class="w">                                              </span>Force<span class="w"> </span>constant<span class="w"> </span><span class="o">(</span>mDyne/Å<span class="o">)</span><span class="w">              </span>Frequency<span class="w"> </span><span class="o">(</span>cm⁻¹<span class="o">)</span>
Bond<span class="o">(</span><span class="m">1</span>,<span class="w"> </span><span class="m">2</span><span class="o">)</span><span class="w">                                                                 </span><span class="m">5</span>.190<span class="w">                          </span><span class="m">3078</span>
Bond<span class="o">(</span><span class="m">1</span>,<span class="w"> </span><span class="m">3</span><span class="o">)</span><span class="w">                                                                 </span><span class="m">5</span>.190<span class="w">                          </span><span class="m">3078</span>
Bond<span class="o">(</span><span class="m">1</span>,<span class="w"> </span><span class="m">4</span><span class="o">)</span><span class="w">                                                                 </span><span class="m">5</span>.190<span class="w">                          </span><span class="m">3078</span>
Bond<span class="o">(</span><span class="m">1</span>,<span class="w"> </span><span class="m">5</span><span class="o">)</span><span class="w">                                                                 </span><span class="m">5</span>.190<span class="w">                          </span><span class="m">3078</span>
</pre></div>
</div>
</div>
</section>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Link to this heading">¶</a></h2>
<p>Local force constants describe the bond strength based on vibrational
frequencies. There are two approaches in the literature: the local modes method
of Cremer <a class="footnote-reference brackets" href="#footcite-konkoli-new-1998" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a> and the compliance matrix method of
Grunenberg <a class="footnote-reference brackets" href="#footcite-brandhorst-how-2008" id="id4" role="doc-noteref"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></a>. They have been shown to be
equivalent within numerical accuracy <a class="footnote-reference brackets" href="#footcite-zou-relating-2012" id="id5" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a>. ᴍᴏʀғᴇᴜs can
use either method, and they give almost identical results except when there are
modes with imaginary or very small frequencies. In these cases, the local modes
approach can handle the issue with  two methods: (1) projecting out imaginary
modes, and (2) raising the force constants of low-frequency modes to a cutoff
value. ᴍᴏʀғᴇᴜs does this projection by default and uses a cutoff of 0.001
mDyne/Å for low-frequency modes. We therefore recommend local modes with
default settings as the most robust method in problematic cases. Expert users
can turn off the projection and alter the cutoff value. Note that interactions
involving imaginary modes (such as breaking/forming bonds in transition states)
cannot be assessed by the local force constants. ᴍᴏʀғᴇᴜs has been benchmarked
against the local force constants and frequencies given by Cremer
<a class="footnote-reference brackets" href="#footcite-zou-relating-2012" id="id6" role="doc-noteref"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></a> for small organic molecules.</p>
<div class="docutils container" id="id7">
<p class="rubric">References</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="footcite-konkoli-new-1998" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id1">1</a>,<a role="doc-backlink" href="#id3">2</a>)</span>
<p>Zoran Konkoli and Dieter Cremer. A new way of analyzing vibrational spectra. I. Derivation of adiabatic internal modes. <em>International Journal of Quantum Chemistry</em>, 67(1):1–9, 1998. <a class="reference external" href="https://doi.org/10.1002/(SICI)1097-461X(1998)67:1&lt;1::AID-QUA1&gt;3.0.CO;2-Z">doi:10.1002/(SICI)1097-461X(1998)67:1&lt;1::AID-QUA1&gt;3.0.CO;2-Z</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-brandhorst-how-2008" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>2<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id2">1</a>,<a role="doc-backlink" href="#id4">2</a>)</span>
<p>Kai Brandhorst and Jörg Grunenberg. How strong is it? The interpretation of force and compliance constants as bond strength descriptors. <em>Chemical Society Reviews</em>, 37(8):1558–1567, 2008. <a class="reference external" href="https://doi.org/10.1039/B717781J">doi:10.1039/B717781J</a>.</p>
</aside>
<aside class="footnote brackets" id="footcite-zou-relating-2012" role="doc-footnote">
<span class="label"><span class="fn-bracket">[</span>3<span class="fn-bracket">]</span></span>
<span class="backrefs">(<a role="doc-backlink" href="#id5">1</a>,<a role="doc-backlink" href="#id6">2</a>)</span>
<p>Wenli Zou, Robert Kalescky, Elfi Kraka, and Dieter Cremer. Relating normal vibrational modes to local vibrational modes with the help of an adiabatic connection scheme. <em>The Journal of Chemical Physics</em>, 137(8):84114, 2012. <a class="reference external" href="https://doi.org/10.1063/1.4747339">doi:10.1063/1.4747339</a>.</p>
</aside>
</aside>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="pyramidalization.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Pyramidalization</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="dispersion.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Dispersion descriptor</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2021, Kjell Jorner
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Local force constants</a><ul>
<li><a class="reference internal" href="#preparing-input">Preparing input</a><ul>
<li><a class="reference internal" href="#local-modes">Local modes</a></li>
<li><a class="reference internal" href="#compliance-matrix">Compliance matrix</a></li>
<li><a class="reference internal" href="#recommended-input">Recommended input</a></li>
<li><a class="reference internal" href="#gaussian">Gaussian</a></li>
<li><a class="reference internal" href="#unimovib">UniMoVib</a></li>
<li><a class="reference internal" href="#xtb">xtb</a></li>
<li><a class="reference internal" href="#geometry-optimizations">Geometry optimizations</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module">Module</a></li>
<li><a class="reference internal" href="#command-line-script">Command line script</a></li>
<li><a class="reference internal" href="#background">Background</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=6dfdf7c3"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=5fa4622c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/tabs.js?v=3ee01567"></script>
    </body>
</html>